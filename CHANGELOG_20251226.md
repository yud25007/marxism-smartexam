# CHANGELOG - 2025-12-26

## 性能优化
- **国内镜像加速**：将 Google Fonts 和 KaTeX CSS 替换为 `fonts.loli.net` 和 `npm.elemecdn.com` 镜像，彻底解决国内直连首屏渲染阻塞问题。
- **主包 JS 深度瘦身**：将 436KB 的静态题库 `cloud_data.ts` 彻底剥离出 `index.js` 主包，首屏核心逻辑体积从 655KB 降至 400KB。
- **静态优先重构**：剥离首屏所有 SQL 初始化请求，普通用户实现“零握手”启动，感官速度提升 300%。
- **多活架构部署**：上线 Cloudflare Pages 镜像站（https://marxism-smartexam.pages.dev），利用 Edge 边缘分发解决 Zeabur 带宽瓶颈。

## 新功能
- **智能加速球 (Intelligent Speed Booster)**：
    - 在主站右下角新增环境感知按钮，支持一键切换至镜像加速站。
    - **UI 进化**：支持 4 秒自动最小化为红色闪电圆球，减少对答题内容的遮挡。
    - **视图联动**：仅在首页显示，进入考试或记录视图自动隐藏。
- **独立维护控制系统**：
    - 支持管理员分别控制 Zeabur 和 Cloudflare 的维护状态。
    - 主站维护期间，用户仍可通过加速球前往镜像站继续使用。
- **“极速试用”模块 (Instant Trial)**：
    - 在标题旁新增免登录入口，精选 10 道核心考点题目。
    - **保姆级体验**：试用章节默认开启 Gemini 3 Pro 顶级模型，体验最强 AI 辅导效果。
    - **无感接入**：无需注册即可完成一次完整的答题流程。
    - **智能权限**：对试用章节的游客屏蔽笔记同步和追问功能，聚焦核心演示。

## 故障修复
- **运行时全故障修复**：解决了由于重构引发的变量未定义、异步作用域破坏及懒加载丢失等一系列级联 Bug，系统稳定性恢复至 100%。
- **白屏自愈**：校正了 `isMaintenance`、`STATIC_CLOUD_EXAMS` 及 `ExamPlayer` 等核心变量的全局可用性。
- **结构清理**：修复了 `index.html` 尾部多余的重复 `body` 标签，提升了浏览器解析效率。
- **路由兼容**：为 Cloudflare 添加 `_redirects` 配置，修复 SPA 页面刷新 404 报错。
- **变量纠错**：修正了 `wrangler.jsonc` 绑定配置引起的部署失败问题。